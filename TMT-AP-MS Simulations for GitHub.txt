Replicate:=1;AUCPearson:={};AUCStudent:={};NonspecificNoninteractMean:=0.3;NonspecificNoninteractStandardDeviation:=0.6;NonspecificNoninteractChannelStandardDeviation:=0.2;BaitLevelsStandardDeviation:=0.3;BaitLevelsChannelStandardDeviation:=0.2;NonspecificBaitMean:=0.1;NonspecificBaitStandardDeviation:=0.01;NonspecificBaitChannelStandardDeviation:=0.2;NonspecificPreyMean:=0.1;NonspecificPreyStandardDeviation:=0.6;NonspecificPreyChannelStandardDeviation:=0.2;RatioMean:=0.3;RatioStandardDeviation:=0.3;RatioChannelStandardDeviation:=0.2;nNI:=500;nPrey:=50;While[Replicate<101,NonspecificNoninteractList:=Evaluate[RandomVariate[TruncatedDistribution[{0,\[Infinity]},NormalDistribution[NonspecificNoninteractMean,NonspecificNoninteractStandardDeviation]],nNI]];NonspecificNoninteractChannelStandardDeviationList:=Evaluate[RandomVariate[TruncatedDistribution[{0,\[Infinity]},NormalDistribution[1,NonspecificNoninteractChannelStandardDeviation]],6*nNI]];NonspecificPreyList:=Evaluate[RandomVariate[TruncatedDistribution[{0,\[Infinity]},NormalDistribution[NonspecificPreyMean,NonspecificPreyStandardDeviation]],nPrey]];NonspecificPreyChannelStandardDeviationList:=Evaluate[RandomVariate[TruncatedDistribution[{0,\[Infinity]},NormalDistribution[1,NonspecificPreyChannelStandardDeviation]],6*nPrey]];PreyRatioList:=Evaluate[RandomVariate[TruncatedDistribution[{0,\[Infinity]},NormalDistribution[RatioMean,RatioStandardDeviation]],nPrey]];PreyRatioChannelStandardDeviationList:=Evaluate[RandomVariate[TruncatedDistribution[{0,\[Infinity]},NormalDistribution[1,RatioChannelStandardDeviation]],6*nPrey]];NonspecificBaitList:=Evaluate[RandomVariate[TruncatedDistribution[{0,\[Infinity]},NormalDistribution[NonspecificBaitMean,NonspecificBaitStandardDeviation]],6]];NonspecificBaitChannelStandardDeviationList:=Evaluate[RandomVariate[TruncatedDistribution[{0,\[Infinity]},NormalDistribution[1,NonspecificBaitChannelStandardDeviation]],6]];BaitLevelsList:=Evaluate[RandomVariate[TruncatedDistribution[{0,\[Infinity]},NormalDistribution[1,BaitLevelsStandardDeviation]],3]];BaitLevelsChannelStandardDeviationList:=Evaluate[RandomVariate[TruncatedDistribution[{0,\[Infinity]},NormalDistribution[1,BaitLevelsChannelStandardDeviation]],3]];NITMT:=Transpose[{Array[NonspecificNoninteractList[[#1]]*NonspecificNoninteractChannelStandardDeviationList[[#1]]&,nNI],Array[NonspecificNoninteractList[[#1]]*NonspecificNoninteractChannelStandardDeviationList[[#1+nNI]]&,nNI],Array[NonspecificNoninteractList[[#1]]*NonspecificNoninteractChannelStandardDeviationList[[#1+2.*nNI]]&,nNI],Array[NonspecificNoninteractList[[#1]]*NonspecificNoninteractChannelStandardDeviationList[[#1+3.*nNI]]&,nNI],Array[NonspecificNoninteractList[[#1]]*NonspecificNoninteractChannelStandardDeviationList[[#1+4.*nNI]]&,nNI],Array[NonspecificNoninteractList[[#1]]*NonspecificNoninteractChannelStandardDeviationList[[#1+5.*nNI]]&,nNI]}];BaitTMT:=Join[Array[NonspecificBaitList[[#1]]*NonspecificBaitChannelStandardDeviationList[[#]]+BaitLevelsList[[#]]*BaitLevelsChannelStandardDeviationList[[#]]&,3],Array[NonspecificBaitList[[#1+3.]]*NonspecificBaitChannelStandardDeviationList[[#+3.]]&,3]];PreyTMT:=Transpose[{Array[NonspecificPreyList[[#1]]*NonspecificPreyChannelStandardDeviationList[[#1]]+PreyRatioList[[#1]]*PreyRatioChannelStandardDeviationList[[#1]]*(BaitLevelsList[[1]]+NonspecificBaitList[[1]])&,nPrey],Array[NonspecificPreyList[[#1]]*NonspecificPreyChannelStandardDeviationList[[#1+nPrey]]+PreyRatioList[[#1]]*PreyRatioChannelStandardDeviationList[[#1+nPrey]]*(BaitLevelsList[[2]]+NonspecificBaitList[[2]])&,nPrey],Array[NonspecificPreyList[[#1]]*NonspecificPreyChannelStandardDeviationList[[#1+2.*nPrey]]+PreyRatioList[[#1]]*PreyRatioChannelStandardDeviationList[[#1+2.*nPrey]]*(BaitLevelsList[[3]]+NonspecificBaitList[[3]])&,nPrey],Array[NonspecificPreyList[[#1]]*NonspecificPreyChannelStandardDeviationList[[#1+3.*nPrey]]+PreyRatioList[[#1]]*PreyRatioChannelStandardDeviationList[[#1+3.*nPrey]]*(NonspecificBaitList[[4]])&,nPrey],Array[NonspecificPreyList[[#1]]*NonspecificPreyChannelStandardDeviationList[[#1+4.*nPrey]]+PreyRatioList[[#1]]*PreyRatioChannelStandardDeviationList[[#1+4.*nPrey]]*(NonspecificBaitList[[5]])&,nPrey],Array[NonspecificPreyList[[#1]]*NonspecificPreyChannelStandardDeviationList[[#1+5.*nPrey]]+PreyRatioList[[#1]]*PreyRatioChannelStandardDeviationList[[#1+5.*nPrey]]*(NonspecificBaitList[[6]])&,nPrey]}];PearsonPrey=Array[PearsonCorrelationTest[PreyTMT[[#]],BaitTMT,"PValue"]&,nPrey];TTestArrayPrey=Array[TTest[{PreyTMT[[#,1;;3]],PreyTMT[[#,4;;6]]}]&,nPrey];PearsonNI=Array[PearsonCorrelationTest[NITMT[[#]],BaitTMT,"PValue"]&,nNI];TTestArrayNI=Array[TTest[{NITMT[[#,1;;3]],NITMT[[#,4;;6]]}]&,nNI];PearsonFP[logalpha_]:=Count[PearsonNI,u_/;u<10.^logalpha];PearsonTP[logalpha_]:=Count[PearsonPrey,u_/;u<10.^logalpha];StudentFP[logalpha_]:=Count[TTestArrayNI,u_/;u<10.^logalpha];StudentTP[logalpha_]:=Count[TTestArrayPrey,u_/;u<10.^logalpha];beta:=Array[.1*#-10.&,100];AppendTo[AUCStudent,Total[Array[(StudentTP[beta[[#]]]+StudentTP[beta[[#+1.]]])*.5*(StudentFP[beta[[#+1.]]]-StudentFP[beta[[#]]])&,99]]/(nPrey*nNI)];AppendTo[AUCPearson,Total[Array[(PearsonTP[beta[[#]]]+PearsonTP[beta[[#+1.]]])*.5*(PearsonFP[beta[[#+1.]]]-PearsonFP[beta[[#]]])&,99]]/(nPrey*nNI)];Replicate++]